{#=====================================================
  About page (DEMO)
  - Information about Flask
  - Information about Jinja
  - Information about Turso
  - Information about PicoCSS
=====================================================#}

{% extends 'pages/base.jinja' %}


{% block title %}

    Posts Feed

{% endblock %}


{% block content %}

    {# add a second query to the home route in init py to find the logged in user's tier #}

    {% for post in posts %}

        {% if (session.tier >= post.min_tier and user.verified == 1) or (session.tier == 0 and user.verified == 1 ) %}
            
            <li>
                <a href="/post/{{ post.p_id }}">
                  <strong>{{ post.title }}</strong> by {{ post.username }}
                </a>

                {% if post.video_id %}

                    <br>

                    <iframe 
                    width="560" height="315" 
                    src="https://www.youtube.com/embed/{{ post.video_id }}" 
                    title="YouTube video player" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                    referrerpolicy="strict-origin-when-cross-origin" 
                    allowfullscreen>
                </iframe>

                {% endif %}

                <p> {{ post.content }}</p>

            </li>
        
        {% else%}

            <p> you need a higher tier to view this post. </p>
        
        {% endif %}
        

    {% else %}

        <p>No posts!</p>

    {% endfor %}

    <br>

    {% if session.tier == 0 %}
    
        <a href="/new-post" role="button">Make a post</a>

    {% endif %}

{% endblock %}

